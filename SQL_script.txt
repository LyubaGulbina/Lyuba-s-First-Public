SELECT Region, State, Product_Name as Product, Round(AVG(Sales/Quantity),2) as avg_Price, COUNT(Order_ID) as count_Orders

FROM `big-query-exam-283517.Demo.Orders` 
WHERE Product_Name LIKE 'Xerox%'
##Region = 'Central'
GROUP BY Region, State, Product_Name
ORDER BY avg_Price


WITH A as(
SELECT Product_Name as Product, Order_ID, Sales, Profit, Discount 
FROM `big-query-exam-283517.Demo.Orders` 
),
B as (
SELECT Order_ID, Returned
FROM `big-query-exam-283517.Demo.Returns`
)
SELECT Product, Returned, Sum(Sales) as sum_Sales, Sum(Profit) as sum_Profit, avg(Discount) as avg_Discount FROM A INNER JOIN  B
ON A.Order_ID=B.Order_ID
GROUP BY Product, Returned
HAVING sum_Profit <0 and avg_Discount>0.1